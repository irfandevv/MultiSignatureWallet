pragma solidity ^0.5.3;

import "testeth/Log.sol";
import "testeth/Assert.sol";
import "testeth/Account.sol";

contract Factory {
  event Deployed(address addr, uint256 salt);

  function deploy1SignerWallet(uint256 threshold, address signatory) public returns (address payable addr) {
    assembly {
      // Multisig Wallet Code Below
      mstore(1000, 0x38610137600039600051305560605b60405160200260600181101561002f5780)
      mstore(1032, 0x518151555b60208101905061000e565b5060f780610040600039806000f350fe)
      mstore(1064, 0x361560f65760003681610424376104a8516103e87f4a0a6d86122c7bd7083e83)
      mstore(1096, 0x912c312adabf207e986f1ac10a35dfeb610d28d0b68152600180300180546104)
      mstore(1128, 0x088181526104c8915085822061046852601987538384537fb0609d81c5f719d8)
      mstore(1160, 0xa516ae2f25079b20fb63da3e07590e23fbf0028e6745e5f260025260a0852060)
      mstore(1192, 0x225260428720945086875b305481101560d05761042860608202610488510101)
      mstore(1224, 0x87815261012c6020816080848e8c610bb8f1508381515411151560c0578a8bfd)
      mstore(1256, 0x5b8051935050505b8581019050608a565b505080518401835550858686836104)
      mstore(1288, 0x285161044851f4151560ef578586fd5b5050505050505b000000000000000000) // only 23 bytes -- 9 bytes shifted

      mstore(1311, threshold) // start where code leaves off
      mstore(1343, 0x0000000000000000000000000000000000000000000000000000000000000040)
      mstore(1375, 0x0000000000000000000000000000000000000000000000000000000000000001) // 1 arr element
      mstore(1407, signatory)

      addr := create(0, 1000, 439)
      if iszero(extcodesize(addr)) {
        revert(0, 0)
      }
    }

    return addr;
  }

  function deploy2SignerWallet(uint256 threshold, address signatory1, address signatory2) public returns (address payable addr) {
    assembly {
      // Multisig Wallet Code Below
      mstore(1000, 0x38610137600039600051305560605b60405160200260600181101561002f5780)
      mstore(1032, 0x518151555b60208101905061000e565b5060f780610040600039806000f350fe)
      mstore(1064, 0x361560f65760003681610424376104a8516103e87f4a0a6d86122c7bd7083e83)
      mstore(1096, 0x912c312adabf207e986f1ac10a35dfeb610d28d0b68152600180300180546104)
      mstore(1128, 0x088181526104c8915085822061046852601987538384537fb0609d81c5f719d8)
      mstore(1160, 0xa516ae2f25079b20fb63da3e07590e23fbf0028e6745e5f260025260a0852060)
      mstore(1192, 0x225260428720945086875b305481101560d05761042860608202610488510101)
      mstore(1224, 0x87815261012c6020816080848e8c610bb8f1508381515411151560c0578a8bfd)
      mstore(1256, 0x5b8051935050505b8581019050608a565b505080518401835550858686836104)
      mstore(1288, 0x285161044851f4151560ef578586fd5b5050505050505b000000000000000000) // only 23 bytes -- 9 bytes shifted

      mstore(1311, threshold) // start where code leaves off
      mstore(1343, 0x0000000000000000000000000000000000000000000000000000000000000060) // 60 end pos
      mstore(1375, 0x0000000000000000000000000000000000000000000000000000000000000002) // 2 arr element
      mstore(1407, signatory1)
      mstore(1439, signatory2)

      addr := create(0, 1000, 471)
      if iszero(extcodesize(addr)) {
        revert(0, 0)
      }
    }

    return addr;
  }
}
